$ ()->
  $('.images-icons').each (i,list)->
    $(list).sortable(
      update: (e, ui) ->
        url = "<%= image_path(0)%>".replace('0', $(ui.item).data('id'))
        $.ajax(
          url: url,
          data:
            'image[position]': $('li', list).index($(ui.item)) + 1,
            _method: 'put'
          success: ->
            window.location = window.location
          type: 'POST',
        )
    )
  $('.image-list').each (i,list)->
    $(list).sortable(
      forcePlaceholderSize: true
      placeholder: "ui-state-highlight"
      update: (e, ui) ->
        $form = $('.next,.previous', ui.item)
        $input = $('input[name="image[position]"]', $form)
        $input.val($('li', list).index($(ui.item)) + 1)
        $form.submit()
    )
